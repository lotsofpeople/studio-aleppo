<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="aleppo-citizen-card.html">
<link rel="import" href="aleppo-citizen-detail-page.html">
<link rel="import" href="aleppo-citizen-card.html">

<!--
`aleppo-citizen-grid`


@demo demo/aleppo-citizen-grid.html
-->

<dom-module id="aleppo-citizen-grid">
  <template>
    <style>
      :host {
        display: block;
      }

      [hidden] {
        display: none!important;
      }

      .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-column-gap: 16px;
        grid-row-gap: 16px;
      }

      @media screen and (min-width: 737px) {
        .grid {
          grid-template-columns: 1fr 1fr 1fr;
        }        
      }

      @media screen and (min-width: 1025px) {
        .grid {
          grid-template-columns: 1fr 1fr 1fr 1fr;
        }        
      }

      aleppo-citizen-card {
        display: flex;
        align-items: stretch;
      }
    </style>

    <section class="grid">
      <template is="dom-repeat" items="[[citizensData]]" as="citizen">
        <aleppo-citizen-card
          citizen-id="[[citizen.id]]"
          citizen-name="[[citizen.name]]"
          quote="[[citizen.quote]]"
          image="[[citizen.portrait_url]]"
          on-tap="_handleTapCitizenCard"
        ></aleppo-citizen-card>
      </template>
    </section>

  </template>

  <script>
    Polymer({

      is: 'aleppo-citizen-grid',

      properties: {

        apiEndpoint: {
          type: String
        },
        
        citizensData: {
          type: Array
        },

        selectedCitizen: {
          type: Object
        }

      },

      observers: [
        '_selectedCitizenChanged(selectedCitizen.*)'
      ],

      _selectedCitizenChanged: function(selectedCitizenChange) {
        console.info('_selectedCitizenChanged', selectedCitizenChange.base);
      },

      _handleTapCitizenCard: function(evt) {
        var citizenData = this._getCitizenDataById(evt.currentTarget.citizenId);
        citizenData.interview = '';
        this.fire('card-tapped', citizenData);
      },

      _getCitizenDataById: function(citizenId) {
        return this.citizensData.filter(function(citizenData) {
          return citizenData.id === citizenId
        })[0] || {};
      }

    });
  </script>
</dom-module>