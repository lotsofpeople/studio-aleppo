<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="aleppo-article.html">

<!--
`aleppo-page`


@demo demo/aleppo-page.html
-->

<dom-module id="aleppo-page">
  <template>
    <style>
      :host {
        display: block;
      }    

      [hidden] {
        display: none!important;
      }

      aleppo-article {
        padding: 24px 0;
      }
  </style>

  <iron-ajax
    url="[[apiEndpoint]]/wp-json/acf/v2/page/[[pageId]]"
    auto="[[pageId]]"
    method="GET"
    handle-as="json"
    last-response="{{pageData}}"
  ></iron-ajax>

  <aleppo-article
    title="[[pageTitle]]"
    content="[[pageData.acf.content]]"
    sidebar-content="[[pageData.acf.sidebar_content]]"
    slideshow-images="[[_parseImages(pageData.acf.slideshow_images.*)]]"
  ></aleppo-article>
     
  </template>

  <script>
    Polymer({

      is: 'aleppo-page',
      properties:{
        
        apiEndpoint: {
          type: String,
        },

        pageId: {
          type: String
        },

        pageTitle: {
          type: String
        },

        pageData: {
          type: Object
        }

      },

      _computeHasSlideshowImages: function(slideshowImages) {
        if (slideshowImages.length > 0) return true;
        return false;
      },

      _parseImages: function(pageDataImagesChange) {
        var pageDataImages = pageDataImagesChange.base;
        return pageDataImages.map(function(pageDataImage) {
          return {src: pageDataImage.sizes.medium, description: pageDataImage.caption}
        })
      }

    });
  </script>
</dom-module>